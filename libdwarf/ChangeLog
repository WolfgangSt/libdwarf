2003-01-21 David Anderson <davea@sgi.com>
      * dwarf_die_deliv.c (dwarf_next_cu_header, dwarf_offdie):
	Add calls to dwarf_load_object() to load .debug_info, 
        .debug_abbrev
      * dwarf_init_finish.c (_dwarf_setup): Remove calls to
        dwarf_load_object for .debug_info, .debug_abbrev sections.
      * dwarf_opaque.h: Add new fields to Dwarf_Debug so
        we don't need to pre-load .debug_info, .debug_abbrev
      * dwarf_util.h: Fix READ_AREA_LENGTH macro so it uses
        only length itself to determine which format the
        length is.

2003-01-14 David Anderson <davea@sgi.com>
      * dwarf_loc.c: Made comment at head of dwarf_loclist()
      a bit clearer.

2002-11-22 Tom Hughes <thh@cyberscience.com>
      * dwarf_macro.c: Corrected bugs in macro-info functions.

2002-10-29 David Anderson <davea@sgi.com>
      * dwarf_init_finish.c: The libelf_sgi mods
      left a HAVE_ELF64_GETSHDR ifdef in the wrong place 
      so folks without Elf64 could not build. Fixed.

2002-10-21 David Anderson <davea@sgi.com>
      * dwarf_form.c: the form_ref functions were failing to
      add in cc_extension_size when checking for offset
      legality. Thanks to Kelly O'Hair <kelly.ohair@sun.com>
      for pointing out the 4 places this was wrong.
      Used cu_context local pointer to avoid numerous
      double indirections.

2002-08-14 David Anderson <davea@sgi.com>
      * dwarf_string.c (dwarf_get_str): Return
      DW_DLV_NO_ENTRY when offset is just at the end of the
      sections, making it possible to use dwarf_get_str
      to print the section independently.
      * libdwarf2.1.mm, libdwarf2.1.ps: Document the
      revised dwarf_get_str interface (which was not
      fully thought thru before).
      * dwarf_line.c (dwarf_srcfiles): Avoid core dump
      when DW_AT_comp_dir absent (it's not required).


2002-07-31 David Anderson <davea@sgi.com>
      * pro_types.c (_dwarf_transform_simplename_to_disk): correct
      generation of .debug_info size field.
      Thanks to Kelly O'Hair <kelly.ohair@sun.com> for pointing out
      the bug.

2002-05-23 Daniel Gohman <gohmandj@sgi.com>
      * dwarf_init_finish.c: Add support for using SGI's
      ELF library as an alternative to using AT&T-style
      libelf.
      Add a new function _dwarf_load_section to handle
      loading of sections.
      * dwarf_opaque.h: Add entries to Dwarf_Debug_s to
      store section indicies.
      * most consumer files: Load sections on demand so
      that unneeded sections don't get loaded.
      * dwarf_init_finish.c: Fixed an incorrect check for
      duplicate .eh_frame sections.

2002-04-25 Kelly O'Hair <kelly.ohair@sun.com>
      * pro_section.c (_dwarf_pro_generate_debuginfo): add
      required dwarf2 sec 7.5.3 trailing null byte 
      to .debug_abbrev per compilation-unit.

2002-03-31 David Anderson <davea@sgi.com>
      * dwarf_abbref.c (dwarf_get_abbrev): change 
      DW_DLE_DEBUG_ABBREV_NULL to DW_DLE_DWARF_ABBREV_NULL. 
      Former was wrong code.
      * libdwarf2.1.mm: correct argument reference, returned_abbrev
      not returned_fde in dwarf_get_abbrev discussion.
      
2002-03-07 David Anderson <davea@sgi.com>
      * libdwarf.h: added struct Elf declaration
      to reduce dependency on header include ordering. 

2002-02-11 David Anderson <davea@sgi.com>
      * libdwarf2.1.mm libdwarf2.1.ps:
      dwarf_offdie can return DW_DLV_NO_ENTRY and that
      is now documented.
      * dwarf_loc.c: if the length of a location description
      is zero that is ok, not an error. dwarf2 sec 2.4.1.

2002-01-10 David Anderson <davea@sgi.com>
      * dwarf_opaque.h, dwarf_init_finish.c: if libdwarf does
      the elf_begin() it must also do the elf_end() to
      avoid a memory leak, and now does this correctly.

2002-01-10  David Anderson <davea@sgi.com>
      * dwarf_init_finish.c:  Using a variable to
      hold ELF_C_READ_MMAP.  Really motivated by
      code not added to this source. 
      * dwarf_die_deliv.c: Added comments, moved
      a couple variables to local scope from function scope.

      * dwarf.h: Added some #defines which were specified in the Dwarf
      2.1 Dwarf draft 5 (now called dwarf 3 draft 5).

2001-09-18  David Anderson davea@sgi.com
	* all files: applied gnu indent with
	-bad -bap -nbbo -br -ce -brs 
	-l72  -lc72  -hnl  -nprs  
	-fca -i4  -lp -psl -npcs 
	Code should use this set in libdwarf.


2001-08-21  "kelly o'hair" <kelly.ohair@eng.sun.com>
	* pro_section.c:  If one called dwarf_add_file_decl()
	  or dwarf_add_directory_decl() but never added a line,
	  .debug_line was not produced.  This was a mistake,
	  as if any file or directory was provided .debug_line
	  should be produced. 

2001-08-06  davea@sgi.com
	* libdwarf2.1.mm: documented dwarf_dealloc rules
	  more clearly. (.ps updated too)
	* mips_extensions.mm: documented the way SGI
	  gets frame stack pointer out of debug_frame.
	  (.ps updated too)

2001-06-14  davea@sgi.com
	* dwarf_leb.c: changed around where bytes counted in
	  _dwarf_decode_s_leb128 so it's easier to tell it is correct.
	  And removed one loop completely: it was
	  an early attempt at performance improvement and
	  is no longer relevant.

	* dwarf_global.c: added new 
	  dwarf_get_cu_die_offset_given_cu_header_offset function
	  to get CU die offset (as the long name says).
	  A variety of functions return cu-header-offsets, so
	  this is useful at times.
	  Used locals to reduce the number of indirections
	  and make things easier to follow.

	* dwarf_arange.c: added new dwarf_get_arange_cu_header_offset
	  function so dwarfdump could print the cu header offset
	  (which appears in the arange headers).

	* libdwarf2.1.mm: documented the above new functions.

2001-06-07  davea@sgi.com
	* dwarf_leb.c: shift operator was not being applied
	  to full size of Dwarf_Signed/Unsigned for 64bit
	  Dwarf_Signed/Unsigned (ILP32 compile) so
	  large numbers not decoded if signed.
	* pro_encode_nm.c: added {} in a couple if/else
          for 'clarity' and to make inserting debug printf easier.
	* pro_expr.c: Added comments explaining why possible
	  compiler (gcc) warnings are ok, the result is safe. 

2001-05-30  davea@sgi.com
	* pro_reloc_stream.c: Wrote Set_REL32_info and 
	  Set_REL64_info macros
	  from generic ELF abi documents to make use acceptable
	  when IRIX elfaccess.h is not available.

2001-05-30  "kelly o'hair" <kelly.ohair@eng.sun.com>
	* Makefile.in: was missing   pro_macinfo.o
 	  pro_encode_nm.o dwarf_macro.o from the OBJS list.

2001-05-22  davea@sgi.com
	* dwarf_frame.c, pro_expr.c: Added comments on why
	  casts are safe in spite of gcc warnings (4 places total).

2001-05-18  Dan Gritter <dgritter@us.ibm.com>
	* dwarf_loc.c DW_OP_bregx operands are unsigned
	  reg num followed by signed offset.

2001-04-11  David Anderson <davea@sgi.com>
	* dwarf_die_deliv.c: check for 0 abbreviation code
	  and return a 'no entry' return value when found.
	  (normal dwarf2, 0 means no DIE, the end of some set of DIEs.)

2001-01-16  David Anderson <davea@sgi.com>

	* pro_die.c: set ar_reloc_len field
	in all cases.

2000-12-14  David Anderson <davea@sgi.com>

	* dwarf_frame.h: clarified some comments.

2000-12-14  Ulrich Drepper <drepper@cygnus.com>

        * dwarf_line.c: Now sets DW_LNE_end_sequence to
        default_is_stmt, the correct value, not is_stmt.


2000 Aug 24  davea@sgi.com
  dwarf_error.c: a dwarf_init() failure resulted in this
	using a static Dwarf_Error struct. And dwarf_dealloc
	did not deal properly with that. 
  dwarf_alloc.c dwarf_alloc.h: these had DYNAMIC_CHUNK protected code
  	which was never used.  Deleted the unused code. Added a small
  	comment (hopefully useful) to dwarf_alloc.h.

	And now deals correctly with a null dbg  on
	DW_DLA_ERROR  due to failed
	dwarf_init() call (or due to other error in calling
	libdwarf that results in libdwarf not knowing the dbg,
	a likely far more common case) and frees the memory.
	This used to result in chaos (depending on your
	luck...).

2000 Aug 23  davea@sgi.com
  libdwarf2.1.mm, ps.  Failed to mention that dwarf_finish()
  has to be accompanied by elf_end() if dwarf_init() was used
  to initialize libdwarf to truly release all stuff.
  Added text to dwarf_finish() describing how to do that.
2000 April 14  davea@sgi.com

  dwarf_abbrev.c - 1.22
        - When it is a null abbrev entry, return it correctly so it can be
          printed (meaning fill out all the return-parameters so the caller can
          do the right thing).

  dwarf_init_finish.c - 1.48
        - For most sections, simply having an empty section (present but empty)
          is just fine. There is no reason to register an error in such a case.

  Copyright has changed. See LIBDWARFCOPYRIGHT and NEWS

  dwarfdump/print_die.c - 1.42
        - Explain what combo checker is doing and make it more maintainable (and          fix bug which would not be hit, but was real enough).

  dwarfdump/tag_tree.list - 1.2
        - Add valid parent/child relationships so checker does not report valid
          entries as bogus.

  dwarf_form.c - 1.26
        - Correct dwarf reader to use appropriate size, not de_length_size. This          is part of the handling of the new dwarf2 64bit facilities. I
          overlooked this small aspect before in one place
  dwarf_query.c - 1.48
        - Use correct size, not de_length_size. For offset size.
  libdwarf2.1.mm - 1.41
        - Tried to make frame register output args meaning clearer
  libdwarf2.1.ps - 1.19
        - Tried to make frame register output args meaning clearer
  pro_forms.c - 1.33
        - Get ref4, not ref8 when generating 32bit dwarf per original dwarf2
          spec. even if pointer size is 64 bits.
  pro_init.c - 1.18
        - Get ref4, not ref8 when generating 32bit dwarf per original dwarf2
          spec. even if pointer size is 64 bits.


davea@sgi.com


2000 March 7
dwarf_line.c - 1.48
dwarf_line.h - 1.16
dwarf_print_lines.c - 1.10
dwarf_sort_line.c - 1.8
        - Now handles opcode_base of line section to be other than that at
          compile time of libdwarf.
Important as the dwarf2 committee is adding a new standard opcode  
davea@sgi.com

2000 Feb 24
pro_forms.c  1.31 ar_next field not always zeroed before.
Could lead to infinite loop in the producer code.
Now the field is always zeroed.

Makefile.in - 1.3 Jason Merrill <jason@cygnus.com>  
 provided fix so gcc will work on libdwarf
print_sections.c - 1.54 - casts to avoid warnings

davea@sgi.com


1999 Dec 14
acconfig.h - 1.3
config.h.in - 1.5
configure - 1.4
configure.in - 1.5
        - HAVE_DWARF2_99_EXTENSION HAVE_OLD_DWARF2_32BIT_OFFSET
          refinements added.
CHANGES - 1.3
Makefile.base - 1.98
NEWS - 1.5
config.h - 1.4
config.h.in - 1.4
configure.in - 1.4
dwarf_alloc.c - 1.36
dwarf_arange.c - 1.19
dwarf_arange.h - 1.6
dwarf_die_deliv.c - 1.51
dwarf_frame.c - 1.62
dwarf_frame.h - 1.23
dwarf_funcs.c - 1.10
dwarf_funcs.h - 1.3
dwarf_global.c - 1.21
dwarf_global.h - 1.7
dwarf_init_finish.c - 1.45
dwarf_line.c - 1.44
dwarf_opaque.h - 1.52
dwarf_print_lines.c - 1.8
dwarf_query.c - 1.45
dwarf_types.c - 1.10
dwarf_types.h - 1.3
dwarf_util.c - 1.40
dwarf_util.h - 1.22
dwarf_vars.c - 1.11
dwarf_vars.h - 1.3
dwarf_weaks.c - 1.10
dwarf_weaks.h - 1.3
libdwarf2.1.mm - 1.40
libdwarf2.1.ps - 1.18
pro_arange.c - 1.15
pro_die.c - 1.23
pro_frame.c - 1.29
pro_init.c - 1.15
pro_macinfo.c - 1.7
pro_opaque.h - 1.14
pro_pubnames.c - 1.18
pro_reloc_stream.c - 1.5
pro_section.c - 1.70
pro_section.h - 1.16
pro_types.c - 1.12
        - Allowing generation of correct dwarf2 with the 1999 64bit dwarf
          extension, and reading all forms of dwarf2 compatibly (all 32/64bit
          dwarf2 section  forms).

This adds the ability to consume and produce both sgi 64bit
and the new dwarf2 committee-approved 64bit dwarf extension.
As a result of the new dwarf2 stuff , a producer (compiler)
can mix 32 and 64bit dwarf (for a 64bit object) and the
linker will work seamlessly.  (as long as section sizes don't
get over 2GBytes).

And the producer is easily configured to produce mips/sgi style
64bit dwarf or the new form of 64bit dwarf.

This also eliminates a fair amount of rather silly duplicated code.
davea@sgi.com


1999 Nov 4

pro_section.c - 1.69
        - A pointer size entity had an offset-size value used at one place.
davea@sgi.com

1999 Sep 30
dwarf_arange.c - 1.18
        - Changed // comment to /* */.  // failed to compile 
          with C89 compiler...
davea@sgi.com


1999 Sep 29
Changed all the producer code
substantially to allow generating assembler code
for the dwarf2 (rather similar to what gcc does)
allowing symbolic relocations.
MIPS output still generates the binary form.
davea@sgi.com



1999 Aug 20
Stan Shebs (shebs@cygnus.com) pointed out that the pro_util.h
use of R_MIPS* was a problem compiling on Sun.
Since the producer code is not really used at present except for
MIPS/sgi, I've added #ifndefs to pro_util.h which provide zero values
when <elf.h> does not provide the macros.
When anyone needs the producer code to actually *work* for non-MIPS
something better will have to be done.

This has no effect on those simply compiling libdwarf for 
use by dwarfdump.
davea@sgi.com

1999 July 21
Changed the READ_UNALAGNED macro to call a function
depending on endianness of the host and the object being read.
So all the dwarf_* source changed in a trivial way.
Added support for printing egcs eh_frame section.
Added a local memcpy-like function to do the cross-endian
thing where applicable (called by READ_UNALIGNED macro). 
Because the .eh_frame section 
after linking can have some zeroed out bytes at the
end of the CIE/FDE data the code looking for CIEs and FDEs
now assumes a zero CIE/FDE length means it has reached
the end of the CIE/FDE data.
davea@sgi.com


1999 June 14
  Fred Fish fnf@ninemoons.com contributed
  autoconf'ing of the libdwarf and dwarfdump source.  
  

  mips_extensions.*  Documented additional old errors
  in the Dwarf Version 2 spec.

  The ChangeLog before this is incomplete. 

-------------------------------------------------------------
Since Oct 95 and before May, 1996 davea@sgi.com David Anderson

Added the function dwarf_get_cie_of_fde() which makes it possible
to remember a single fde/cie set out of a block usefully.

Enhanced doc of dwarf_bitoffset()

Added new function dwarf_global_formref() so all reference
forms can be retrieved.

Fixed bug in retrieving array bounds: was failing to sign extend
formsdata.

Added function dwarf_get_fde_info_for_all_regs(), which makes
retrieval of the complete set of registers (as needed by
debuggers and exception handlers) effectively N times faster
than getting them one a time where N is the number of registers.

Added support for exception table handling (really just support
for a reference to an exception table for c++ exceptions).

Fixed a bug where useless extra space (several megabytes)
were malloc'ed for the abbreviations table by the libdwarf
consumer code.

-------------------------------------------------------------
June 10, 1999
 Changelog started.
-------------------------------------------------------------
